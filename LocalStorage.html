<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap demo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<style>
  body {
    background-color: #f8f9fa;
  }

  .container {
    max-width: 500px;
    margin-top: 50px;
    background: white;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  }
</style>

<body>

  <div class="container">
    <h2>Login</h2>
    <form id="loginForm">
      <div class="form-group">
        <label for="email">Email:</label>
        <input type="email" class="form-control" id="email" required>
      </div>
      <div class="form-group">
        <label for="pwd">Password:</label>
        <input type="password" class="form-control" id="pwd" required>
      </div>
      <button type="submit" class="btn btn-primary my-2">Login</button>
    </form>
  </div>

  <div class="container">
    <h2>Register</h2>
    <form id="registerForm">
      <div class="form-group">
        <label for="name">Name:</label>
        <input type="text" class="form-control" id="name" required>
      </div>
      <div class="form-group">
        <label for="registerEmail">Email:</label>
        <input type="email" class="form-control" id="registerEmail" required>
      </div>
      <div class="form-group">
        <label for="registerPwd">Password:</label>
        <input type="password" class="form-control" id="registerPwd" required>
      </div>
      <button type="submit" class="btn btn-primary my-2">Register</button>
    </form>
  </div>

  <div class="container">
    <h2>Recuperar Contraseña</h2>
    <form id="recoverForm">
      <div class="form-group">
        <label for="recoverEmail">Email:</label>
        <input type="email" class="form-control" id="recoverEmail" required>
      </div>
      <button type="submit" class="btn btn-primary my-2">Recuperar</button>
    </form>
  </div>

  <div class="container my-5">
    <h2>Gestionar Almacenamiento</h2>
    <button id="clearStorageBtn" class="btn btn-danger my-2">Limpiar Datos</button>
  </div>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const registerForm = document.getElementById("registerForm");
      const loginForm = document.getElementById("loginForm");
      const recoverForm = document.getElementById("recoverForm");

      //Registro
      registerForm.addEventListener("submit", function (event) {
        event.preventDefault();
        const name = document.getElementById("name").value;
        const email = document.getElementById("registerEmail").value;
        const password = document.getElementById("registerPwd").value;

        // Obtener usuarios existentes o inicializar un objeto vacío si no hay usuarios
        const users = JSON.parse(localStorage.getItem("users")) || {};

        // Verificar si el correo electrónico ya está registrado
        if (users[email]) {
          alert("El correo electrónico ya está registrado");
        } else {
          // Registrar el nuevo usuario
          users[email] = { name, email, password };
          localStorage.setItem("users", JSON.stringify(users));
          alert("Registro exitoso");
        }
      });

      // Iniciar Sesión
      loginForm.addEventListener("submit", function (event) {
        event.preventDefault();
        const email = document.getElementById("email").value;
        const password = document.getElementById("pwd").value;

        // Obtener usuarios existentes
        const users = JSON.parse(localStorage.getItem("users")) || {};

        // Verificar si el usuario existe y las credenciales son correctas
        if (users[email] && users[email].password === password) {
          alert("Login exitoso");
          // Establecer indicador de sesión al iniciar sesión
          localStorage.setItem("isLoggedIn", true);
          // Guardar el correo electrónico del usuario actualmente autenticado
          localStorage.setItem("currentUser", email);
          window.location.href = "perfil.html";
        } else {
          alert("Credenciales incorrectas");
        }
      });



      //Recuperar Contraseña
      recoverForm.addEventListener("submit", function (event) {
        event.preventDefault();
        const email = document.getElementById("recoverEmail").value;
        const storedUser = JSON.parse(localStorage.getItem("user"));
        if (storedUser && storedUser.email === email) {
          alert(`Su contraseña es: ${storedUser.password}`);
        } else {
          alert("Email no registrado");
        }
      });
    });

    // Limpiar localStorage
    if (clearStorageBtn) {
      clearStorageBtn.addEventListener("click", function () {
        localStorage.clear();
        alert("Datos de almacenamiento local limpiados.");
      });
    }

  </script>
</body>

</html>